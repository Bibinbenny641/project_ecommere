{% extends 'demo2.html' %}
{% load static %}

{% block content %}

<body class="">

  <!-- Header -->
  <header class="header-v4">
    <!-- Header desktop -->
    <div class="container-menu-desktop">
      <!-- Topbar -->
      <div class="top-bar">
        <div class="content-topbar flex-sb-m h-full container">
          <div class="left-top-bar">

          </div>

          <div class="right-top-bar flex-w h-full">
            <a href="#" class="flex-c-m trans-04 p-lr-25">
              Help & FAQs
            </a>

            <a href="#" class="flex-c-m trans-04 p-lr-25">

            </a>

            <a href="#" class="flex-c-m trans-04 p-lr-25">
              EN
            </a>

            <a href="#" class="flex-c-m trans-04 p-lr-25">
              USD
            </a>
          </div>
        </div>
      </div>

      <div class="wrap-menu-desktop how-shadow1">
        <nav class="limiter-menu-desktop container">

          <!-- Logo desktop -->
          <a href="#" class="logo">
            <!-- <img src="{% static 'user/images/icons/logo-01.png'%}" alt="IMG-LOGO"> -->
            <h1 style="color: black;font-family: 'Times New Roman', Times, serif;"><span
                style="font-weight: 900;">MORE</span> BUY</h1>
          </a>

          <!-- Menu desktop -->
          <div class="menu-desktop">
            <ul class="main-menu">
              <li>
                <a href="{% url 'home' %}">Home</a>

              </li>

              <li class="active-menu">
                <a href="{% url 'viewproduct' %}">Shop</a>
              </li>

              <li>
                <a href="">About</a>
              </li>

              <li>
                <a href="">Contact</a>
              </li>
            </ul>
          </div>

          <!-- Icon header -->
          <div class="wrap-icon-header flex-w flex-r-m">

            <div class="" style="padding-right:30px ;">
              <a class="me-5" style="text-decoration: none;color: black; " href="{% url 'viewcart' %}"><i
                  class="fa-solid fa-cart-shopping" style="font-size: 20px;"></i></a>


            </div>
            <div class="div" style="padding-right:30px ;">
              <a class="me-5" style="text-decoration: none;color: black; " href="{% url 'viewwishlist' %}"><i
                  class="fa-regular fa-heart" style="font-size: 20px;"></i></a>

            </div>
            <div class="div" style="padding-right:30px ;">
              <ul class="main-menu">
                {% if request.user.is_authenticated %}
                <li class="active-menu">
                  <a class="me-5" style="text-decoration: none;color: black; "><i class="fa-solid fa-user"
                      style="font-size: 20px;"></i></a>

                  <ul class="sub-menu">
                    <li><a href="{% url 'myprofile' %}">My Profile</a></li>
                    <li><a href="{% url 'myorder' %}">My orders</a></li>
                    <li><a href="{% url 'logoutuser' %}">Logout</a></li>
                  </ul>
                </li>
                {% else %}
                <li class="active-menu">
                  <a class="me-5" style="text-decoration: none;color: black; " href="{% url 'userlogin' %}"><i
                      class="fa-solid fa-user" style="font-size: 20px;"></i></a>
                </li>
                {% endif %}
              </ul>
            </div>
          </div>
        </nav>
      </div>
    </div>

    <!-- Header Mobile -->
    <div class="wrap-header-mobile">
      <!-- Logo moblie -->
      <div class="logo-mobile">
        <a href="{% url 'home' %}">
          <h4 style="color: black;font-family: 'Times New Roman', Times, serif;"><span
              style="font-weight: 900;">MORE</span> BUY</h4>
        </a>
      </div>

      <!-- Icon header -->
      <div class="wrap-icon-header flex-w flex-r-m m-r-15">

        <a href="{% url 'viewcart' %}" class="dis-block icon-header-item cl2 hov-cl1 trans-04 p-r-11 p-l-10 ">
          <i class="zmdi zmdi-shopping-cart"></i>
        </a>
        <a href="{% url 'viewwishlist' %}" class="dis-block icon-header-item cl2 hov-cl1 trans-04 p-r-11 p-l-10 ">
          <i class="zmdi zmdi-favorite-outline"></i>
        </a>

        <a href="{% url 'myprofile' %}" class="dis-block icon-header-item cl2 hov-cl1 trans-04 p-r-11 p-l-10 ">
          <i class="fa-solid fa-user"></i>
        </a>
      </div>

      <!-- Button show menu -->
      <div class="btn-show-menu-mobile hamburger hamburger--squeeze">
        <span class="hamburger-box">
          <span class="hamburger-inner"></span>
        </span>
      </div>
    </div>


    <!-- Menu Mobile -->
    <div class="menu-mobile">
      <ul class="topbar-mobile">
        <li>
          <div class="left-top-bar">
            Free shipping for standard order over $100
          </div>
        </li>

        <li>
          <div class="right-top-bar flex-w h-full">
            <a href="#" class="flex-c-m p-lr-10 trans-04">
              Help & FAQs
            </a>

            <a href="{% url 'myprofile' %}" class="flex-c-m p-lr-10 trans-04">
              My Account
            </a>

            <a href="#" class="flex-c-m p-lr-10 trans-04">
              EN
            </a>

            <a href="#" class="flex-c-m p-lr-10 trans-04">
              USD
            </a>
          </div>
        </li>
      </ul>

      <ul class="main-menu-m">
        <li>
          <a href="{% url 'viewproduct' %}">Products</a>
        </li>


        <li>
          <a href="{% url 'myorder' %}">My Orders</a>
        </li>

        <li>
          {% if request.user.is_authenticated %}
          <a href="{% url 'logoutuser' %}">Logout</a>
          {% endif %}
        </li>
      </ul>
    </div>

    <!-- Modal Search -->
    <div class="modal-search-header flex-c-m trans-04 js-hide-modal-search">
      <div class="container-search-header">
        <button class="flex-c-m btn-hide-modal-search trans-04 js-hide-modal-search">
          <!-- <img src="{% static 'user/images/icons/icon-close2.png'%}" alt="CLOSE"> -->
        </button>

        <form class="wrap-search-header flex-w p-l-15">

          <input class="plh3" type="text" name="search" placeholder="Search...">
        </form>
      </div>
    </div>
  </header>



  <form class="bg0 p-t-75 p-b-85">
    <div class="container">
      <div class="row">
        <div class="col-lg-10 col-xl-7 m-lr-auto m-b-50">
          <div class="m-l-25 m-r--38 m-lr-0-xl">
            <div class="wrap-table-shopping-cart">
              {% if ob %}
              {% for i in ob %}
              <div class="card rounded-3 mb-4">
                <div class="card-body p-4">
                  <div class="row d-flex justify-content-between align-items-center">
                    <div class="col-md-2 col-lg-2 col-xl-2">
                      <img src="/media/{{ i.image }}" class="img-fluid rounded-3">
                    </div>
                    <div class="col-md-3 col-lg-3 col-xl-3">
                      <p class="lead fw-normal mb-2">{{i.productname}}</p>

                    </div>

                    <div class="col-md-3 col-lg-3 col-xl-2 d-flex">
                      {% csrf_token %}

                      <button style="border: 10px; color: red;" type="button" class="btn btn-link px-2"
                        onclick="changeQuantity({{i.id}},-1)">
                        <i class="fas fa-minus"></i>
                      </button>


                      <span id="{{i.id}}" name="quantity">{{i.quantity}}</span>

                      <button type="button" class="btn btn-link px-2" onclick="changeQuantity({{i.id}},1)">
                        <i class="fas fa-plus"></i>
                      </button>
                    </div>
                    <div class="col-md-3 col-lg-2 col-xl-2 offset-lg-1">
                      <h5 class="mb-0" id="{{i.id}}amount">Rs. {{i.price}}</h5>
                    </div>

                    <div class="col-md-1 col-lg-1 col-xl-1 text-end">
                      <a class="text-danger" href="{% url 'removecart' i.id %}"><i class="fas fa-trash fa-lg "></i></a>
                    </div>
                  </div>
                </div>
              </div>
              {% endfor %}
              {% else %}
              <center>
                <h5>Your cart is Empty..ðŸ˜«</h5>
              </center><br>
              <hr>
              <center> <a
                  class="flex-c-m stext-101 cl0 size-116 bg3 bor14 hov-btn3 p-lr-15 trans-04 pointer btn btn-success"
                  href="{% url 'viewproduct' %}" role="button"> Countinue Shopping</a></center>
              {% endif %}

            </div>


          </div>
        </div>

        <div class="col-sm-10 col-lg-7 col-xl-5 m-lr-auto m-b-50">
          <div class="bor10 p-lr-40 p-t-30 p-b-40 m-l-63 m-r-40 m-lr-0-xl p-lr-15-sm">
            <h4 class="mtext-109 cl2 p-b-30">
              Cart Totals
            </h4>

            <div class="flex-w flex-t p-t-27 p-b-33">
              <div class="size-208">
                <span class="mtext-101 cl2">
                  Total:
                </span>
              </div>

              <div class="size-209 p-t-1">
                <span class="mtext-110 cl2">
                  <p id="total">Rs.  {{total}}</p>

                </span>
              </div>
            </div>
            {% if ob %}
            <a class="flex-c-m stext-101 cl0 size-116 bg3 bor14 hov-btn3 p-lr-15 trans-04 pointer btn btn-success"
              href="{% url 'checkout' %}" role="button"> Countinue to Checkout</a>
            {% endif %}


          </div>
        </div>
      </div>
    </div>
  </form>

  <!-- Back to top -->
  <div class="btn-back-to-top" id="myBtn">
    <span class="symbol-btn-back-to-top">
      <i class="zmdi zmdi-chevron-up"></i>
    </span>
  </div>

  <!-- Modal1 -->

  </div>

  <script>

    function changeQuantity(id, count) {
      var sumith = document.getElementById(id)

      if (count == -1) {
        $.ajax({
          headers: {
            "X-CSRFToken": $('[name=csrfmiddlewaretoken]').val()

          },
          type: "POST",
          url: "{% url 'dquantity' %}",

          data: {

            id: id

          },
          success: function (response) {
            console.log("hhhhh")
            quan = response.q
            total = response.total
            amount = response.amount
            document.getElementById(id).innerHTML = quan
            let a = id + 'amount'

            k = document.getElementById(a)
            k.innerHTML = amount
            j = document.getElementById('total')
            j.innerHTML = total

          }
        })
      } else {
        $.ajax({
          headers: {
            "X-CSRFToken": $('[name=csrfmiddlewaretoken]').val()

          },
          type: "POST",
          url: "{% url 'iquantity' %}",

          data: {

            id: id


          },
          success: function (response) {
            console.log(response)
            quan = response.q
            total = response.total
            amount = response.amount
            let a = id + 'amount'
            document.getElementById(id).innerHTML = quan
            k = document.getElementById(a)

            console.log(response.total)
            k.innerHTML = amount
            j = document.getElementById('total')
            j.innerHTML = total
          }
        })
      }


    }

  </script>
  


</body>
{% endblock content %}